<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>FriendFinder</title>

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4"
    crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
    crossorigin="anonymous"></script>

  <!-- Font Awesome Glyphicons -->
  <link href="https://use.fontawesome.com/releases/v5.0.4/css/all.css" rel="stylesheet">

  <!-- Chosen -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.5/chosen.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.5/chosen.jquery.min.js"></script>

</head>

<body>

  <div class="container">
    <div class="jumbotron">
      <h1 class="display-4 text-center">
        <i class="fas fa-user-plus"></i> Friend Finder</h1>
      <hr class="my-4">
      <p class="lead text-center">Answer a few basic questions.</p>
      <p class="lead text-center">And find a new friend with Freind Finder! The easy way to make new friends</p>
      <div class="text-center">
        <a href="/api/friends">
          <button type="button" class="btn btn-lg btn-primary">
            <i class="fas fa-address-card"></i> View Friends</button>
        </a>
        <a href="/">
          <button type="button" class="btn btn-outline-dark btn-lg">
            <i class="fas fa-home"></i>
            </i>
          </button>
        </a>

      </div>
    </div>

    <div class="card">
      <div class="card-header">
        Survey Questions
      </div>
      <div class="card-body">
        <form>
          <div class="row">

            <div class="col-md-6">
              <h6 class="card-title">Your Information:</h6>
              <div class="form-group">
                <label for="name">Name (Required):</label>
                <input type="text" id="name" class="form-control" required>
                <small id="nameHelp" class="form-text text-muted">We'll never share your info with anyone else.</small>
              </div>
              <div class="form-group">
                <label for="photo">Link to Photo Image (Required):</label>
                <input type="text" id="photo" class="form-control" required>
              </div>

              <h6 class="card-title">Question 1</h6>
              <div class="form-group">
                <label for="q1">Your mind is always buzzing with unexplored ideas and plans.</label>
                <select class="form-control" id="q1">
                  <option>1 (Strongly Disagree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Strongly Agree)</option>
                </select>
              </div>

              <h6 class="card-title">Question 2</h6>
              <div class="form-group">
                <label for="q2">Generally speaking, you rely more on your experience than your imagination.</label>
                <select class="form-control" id="q2">
                  <option>1 (Strongly Disagree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Strongly Agree)</option>
                </select>
              </div>

              <h6 class="card-title">Question 3</h6>
              <div class="form-group">
                <label for="q3">You find it easy to stay relaxed and focused even when there is some pressure.</label>
                <select class="form-control" id="q3">
                  <option>1 (Strongly Disagree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Strongly Agree)</option>
                </select>
              </div>

              <h6 class="card-title">Question 4</h6>
              <div class="form-group">
                <label for="q4">You rarely do something just out of sheer curiosity.</label>
                <select class="form-control" id="q4">
                  <option>1 (Strongly Disagree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Strongly Agree)</option>
                </select>
              </div>
            </div>
            <div class="col-md-6">
              <h6 class="card-title">Question 5</h6>
              <div class="form-group">
                <label for="q5">People can rarely upset you.</label>
                <select class="form-control" id="q5">
                  <option>1 (Strongly Disagree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Strongly Agree)</option>
                </select>
              </div>

              <h6 class="card-title">Question 6</h6>
              <div class="form-group">
                <label for="q6">It is often difficult for you to relate to other people’s feelings.</label>
                <select class="form-control" id="q6">
                  <option>1 (Strongly Disagree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Strongly Agree)</option>
                </select>
              </div>

              <h6 class="card-title">Question 7</h6>
              <div class="form-group">
                <label for="q7">In a discussion, truth should be more important than people’s sensitivities.</label>
                <select class="form-control" id="q7">
                  <option>1 (Strongly Disagree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Strongly Agree)</option>
                </select>
              </div>

              <h6 class="card-title">Question 8</h6>
              <div class="form-group">
                <label for="q8">You rarely get carried away by fantasies and ideas.</label>
                <select class="form-control" id="q8">
                  <option>1 (Strongly Disagree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Strongly Agree)</option>
                </select>
              </div>


              <h6 class="card-title">Question 9</h6>
              <div class="form-group">
                <label for="q9">You think that everyone’s views should be respected regardless of whether they are supported by facts or
                  not.
                </label>
                <select class="form-control" id="q9">
                  <option>1 (Strongly Disagree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Strongly Agree)</option>
                </select>
              </div>

              <h6 class="card-title">Question 10</h6>
              <div class="form-group">
                <label for="q10">You feel more energetic after spending time with a group of people.</label>
                <select class="form-control" id="q10">
                  <option>1 (Strongly Disagree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Strongly Agree)</option>
                </select>
              </div>
            </div>
          </div>

          <body class="container-fluid">
            <!-- <div class="row"> -->
              <div class="col-6" style="float: none; margin: 0 auto;">
                <!-- Submit Button -->
                <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit">
                  <i class="fa fa-check-circle" aria-hidden="true"></i>
                  Submit</button>
              </div>
            <!-- </div> -->
          </body>
        </form>
      </div>
    </div>

    <footer class="footer">
      <div class="container">
        <p>
          <a href="/api/friends">API Friends List</a> |
          <a href="https://github.com/climba/FriendFinder">GitHub Repo</a>
        </p>
      </div>
    </footer>

  </div>


  <!-- Modal -->
  <div id="results-modal" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Best Match</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>Thanks for using Friend Finder, we have found your match!</p>
          <img src="http://www.istpd.com/assets/images/best_friends.jpg" height="300px" alt="">
          <div class="mt-2">We have matched you with <span style="font-weight: bold;" id="match-name"></span>!</div>
          <p>Here's their photo:</p>
          <img id="match-img" class="img-responsive">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>


  <script type="text/javascript">
    // Chosen CSS
    var config = {
      ".chosen-select": {},
      ".chosen-select-deselect": {
        allow_single_deselect: true
      },
      ".chosen-select-no-single": {
        disable_search_threshold: 10
      },
      ".chosen-select-no-results": {
        no_results_text: "Oops, nothing found!"
      },
      ".chosen-select-width": {
        width: "95%"
      }
    };

    for (var selector in config) {
      $(selector).chosen(config[selector]);
    }

    // Capture the form inputs
    $("#submit").on("click", function (event) {
      event.preventDefault();

      // Form validation
      function validateForm() {
        var isValid = true;
        $(".form-control").each(function () {
          if ($(this).val() === "") {
            isValid = false;
          }
        });

        $(".chosen-select").each(function () {

          if ($(this).val() === "") {
            isValid = false;
          }
        });
        return isValid;
      }

      // If all required fields are filled
      if (validateForm()) {
        // Create an object for the user"s data
        var userData = {
          name: $("#name").val(),
          photo: $("#photo").val(),
          scores: [
            $("#q1").val(),
            $("#q2").val(),
            $("#q3").val(),
            $("#q4").val(),
            $("#q5").val(),
            $("#q6").val(),
            $("#q7").val(),
            $("#q8").val(),
            $("#q9").val(),
            $("#q10").val()
          ]
        };

        // AJAX post the data to the friends API.
        $.post("/api/friends", userData, function (data) {

          // Grab the result from the AJAX post so that the best match's name and photo are displayed.
          $("#match-name").text(data.name);
          $("#match-img").attr("src", data.photo);

          // Show the modal with the best match
          $("#results-modal").modal("toggle");

          // Clears the form when the user closes the modal
          $('#results-modal').on('hidden.bs.modal', function () {
            console.log("test on modal close");
            $('form').get(0).reset()
          });

        });
      } else {
        alert("Please fill out all fields before submitting!");
      }
    });
  </script>

</body>

</html>